<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Upload Resume – HireCraft AI</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="dashboard-body">

<!-- ===== HEADER ===== -->
<div class="dashboard-header">
  <h2>Upload Resume</h2>
</div>

<!-- ===== UPLOAD CONTAINER ===== -->
<div class="dashboard-container" style="grid-template-columns: 1fr; max-width: 600px; margin: auto;">

  <div class="dashboard-panel">

    <h3>Select Your Resume</h3>
    <p style="color:#555; font-size:14px;">
      Supported formats: <b>PDF, JPG, JPEG</b> (Max 1MB)
    </p>

    <!-- File Input -->
    <input
      type="file"
      id="resume"
      accept=".pdf,.jpg,.jpeg"
      style="margin: 20px 0;"
    >

    <!-- Upload Button -->
    <button onclick="upload()" style="width:100%; margin-top:10px;">
      ⬆ Upload Resume
    </button>

    <!-- Status Message -->
    <p id="msg" style="margin-top:15px; font-weight:600;"></p>

    <!-- Progress bar -->
    <div id="progressWrap" style="display:none; margin-top:15px;">
      <div style="background:#e5e7eb; height:8px; border-radius:6px;">
        <div id="progressBar"
             style="width:0%; height:100%; background:#1e88e5; border-radius:6px;">
        </div>
      </div>
    </div>

  </div>
</div>

<!-- ===== SCRIPT ===== -->
<script>
function upload() {
  const fileInput = document.getElementById("resume");
  const msg = document.getElementById("msg");
  const progressWrap = document.getElementById("progressWrap");
  const progressBar = document.getElementById("progressBar");

  const file = fileInput.files[0];
  if (!file) {
    msg.innerText = "Please select a file first";
    msg.style.color = "red";
    return;
  }

  const fd = new FormData();
  fd.append("resume", file);

  msg.innerText = "Uploading resume...";
  msg.style.color = "#1e88e5";
  progressWrap.style.display = "block";
  progressBar.style.width = "30%";

  fetch("/api/upload", {
    method: "POST",
    body: fd
  })
  .then(res => res.json())
  .then(data => {
    if (data.success) {
      progressBar.style.width = "100%";
      msg.innerText = "✅ Resume uploaded successfully!";
      msg.style.color = "green";

      setTimeout(() => {
        window.location.href = "/dashboard";
      }, 1200);

    } else {
      msg.innerText = data.message || "Upload failed";
      msg.style.color = "red";
      progressWrap.style.display = "none";
    }
  })
  .catch(() => {
    msg.innerText = "Something went wrong. Try again.";
    msg.style.color = "red";
    progressWrap.style.display = "none";
  });
}
</script>

</body>
</html>
